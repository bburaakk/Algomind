#:kivy 2.1.0
#:import MDNavigationDrawer kivymd.uix.navigationdrawer.MDNavigationDrawer
#:import MDTopAppBar kivymd.uix.toolbar.MDTopAppBar
#:import OneLineIconListItem kivymd.uix.list.OneLineIconListItem
#:import IconLeftWidget kivymd.uix.list.IconLeftWidget
#:import MDScreen kivymd.uix.screen.MDScreen
#:import MDNavigationLayout kivymd.uix.navigationdrawer.MDNavigationLayout


# Bu kural, RaporEkrani'nin içeriğini tanımlar.
# Bu bir MDScreen'dir ve ScreenManager içinde yer alır.
<RaporEkrani>:
    name: 'rapor_ekrani_screen'

    BoxLayout:
        orientation: 'vertical'

        MDTopAppBar:
            title: "Rapor Ekranı"
            elevation: 10
            # Düzeltme: Menü butonu, MDApp'in root'u üzerinden nav_drawer'a erişecek.
            left_action_items: [['menu', lambda x: app.root.ids.nav_drawer.set_state("open" if app.root.ids.nav_drawer.state == "close" else "close")]]
            md_bg_color: (74/255, 144/255, 226/255, 1)

        BoxLayout:
            orientation: 'vertical'
            padding: '20dp'
            spacing: '20dp'

            canvas.before:
                Color:
                    rgba: (74/255, 144/255, 226/255, 1)
                Rectangle:
                    pos: self.pos
                    size: self.size

            # Grafikler Bölümü
            BoxLayout:
                orientation: 'horizontal'
                spacing: '20dp'
                size_hint_y: 0.45

                # Sol Grafik Kartı
                BoxLayout:
                    orientation: 'vertical'
                    padding: '10dp'
                    canvas.before:
                        Color:
                            rgba: (1, 1, 1, 1)
                        RoundedRectangle:
                            pos: self.pos
                            size: self.size
                            radius: [15,]
                    Label:
                        text: 'Zamana Göre Gelişim'
                        font_size: '18sp'
                        color: (0.2, 0.2, 0.2, 1)
                        size_hint_y: None
                        height: '30dp'
                        halign: 'left'
                        text_size: self.width, None
                    Image:
                        source: 'algomind/assets/grafik.png'
                        # Deprecated özellikler yerine fit_mode kullanıldı.
                        fit_mode: "fill"

                # Sağ Grafik Kartı
                BoxLayout:
                    orientation: 'vertical'
                    padding: '10dp'
                    canvas.before:
                        Color:
                            rgba: (1, 1, 1, 1)
                        RoundedRectangle:
                            pos: self.pos
                            size: self.size
                            radius: [15,]
                    Label:
                        text: 'Konu Performansı'
                        font_size: '18sp'
                        color: (0.2, 0.2, 0.2, 1)
                        size_hint_y: None
                        height: '30dp'
                        halign: 'left'
                        text_size: self.width, None
                    Image:
                        source: 'algomind/assets/grafik.png'
                        # Deprecated özellikler yerine fit_mode kullanıldı.
                        fit_mode: "fill"

            # Detaylı Analiz Bölümü
            ScrollView:
                size_hint_y: 0.45
                canvas.before:
                    Color:
                        rgba: (1, 1, 1, 1)
                    RoundedRectangle:
                        pos: self.pos
                        size: self.size
                        radius: [15,]
                GridLayout:
                    cols: 1
                    size_hint_y: None
                    height: self.minimum_height
                    padding: '15dp'
                    spacing: '10dp'
                    Label:
                        text: 'Detaylı Analiz'
                        font_size: '20sp'
                        bold: True
                        color: (0.1, 0.1, 0.1, 1)
                        size_hint_y: None
                        height: '40dp'
                    Label:
                        id: report_text_content
                        text: "Rapor içeriği yükleniyor..."
                        font_size: '15sp'
                        color: (0.4, 0.4, 0.4, 1)
                        size_hint_y: None
                        height: self.texture_size[1]
                        markup: True
                        text_size: self.width, None
                        line_height: 1.5

