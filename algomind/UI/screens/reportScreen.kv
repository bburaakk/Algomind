#:kivy 2.1.0
#:import get_color_from_hex kivy.utils.get_color_from_hex
#:import MDTopAppBar kivymd.uix.toolbar.MDTopAppBar
#:import MDScreen kivymd.uix.screen.MDScreen
#:import MDCard kivymd.uix.card.MDCard
#:import MDLabel kivymd.uix.label.MDLabel
#:import MDSeparator kivymd.uix.card.MDSeparator
#:import IconLeftWidget kivymd.uix.list.IconLeftWidget

# --- Özel bir başlık etiketi ---
<ReportSectionHeader@BoxLayout>:
    orientation: 'horizontal'
    size_hint_y: None
    height: self.minimum_height
    spacing: dp(15)
    icon: ''
    text: ''

    IconLeftWidget:
        icon: root.icon
        theme_text_color: "Custom"
        text_color: get_color_from_hex('#357ABD')
        font_size: '32sp'

    MDLabel:
        text: root.text
        font_style: "H6"
        adaptive_height: True
        color: get_color_from_hex('#1E3A5F')

# --- İçerik etiketi ---
<ReportContentLabel@MDLabel>:
    font_style: "Body1"
    adaptive_height: True
    color: get_color_from_hex('#334E68')
    markup: True
    line_height: 1.4
    padding: [dp(10), 0, 0, 0]


# --- ANA RAPOR EKRANI ---
<RaporEkrani>:
    name: 'rapor_ekrani_screen'

    BoxLayout:
        orientation: 'vertical'
        canvas.before:
            Color:
                rgba: get_color_from_hex('#F0F4F8')
            Rectangle:
                pos: self.pos
                size: self.size

        MDTopAppBar:
            title: "Gelişim Raporu"
            elevation: 0
            left_action_items: [['menu', lambda x: app.root.ids.nav_drawer.set_state("open" if app.root.ids.nav_drawer.state == "close" else "close")]]
            md_bg_color: get_color_from_hex('#F0F4F8')
            specific_text_color: get_color_from_hex('#1E3A5F')

        ScrollView:
            bar_width: dp(8)
            bar_color: get_color_from_hex('#357ABD')

            GridLayout:
                cols: 1
                padding: dp(20)
                spacing: dp(20)
                size_hint_y: None
                height: self.minimum_height

                # --- Öğrenci Bilgi Kartı ---
                MDCard:
                    orientation: 'horizontal'
                    padding: dp(15)
                    size_hint_y: None
                    height: dp(60)
                    md_bg_color: 1, 1, 1, 1
                    radius: [dp(15)]

                    IconLeftWidget:
                        icon: 'account-child'
                        theme_text_color: "Custom"
                        text_color: get_color_from_hex('#357ABD')

                    MDLabel:
                        id: student_name_label
                        text: "Öğrenci Adı Yükleniyor..."
                        font_style: "H6"
                        color: get_color_from_hex('#1E3A5F')

                # --- Gemini Rapor Kartı ---
                MDCard:
                    orientation: 'vertical'
                    padding: dp(25)
                    spacing: dp(20)
                    size_hint_y: None
                    height: self.minimum_height
                    md_bg_color: 1, 1, 1, 1
                    radius: [dp(15)]

                    MDLabel:
                        text: "Gemini Gelişim Analizi"
                        font_style: "H5"
                        halign: 'center'
                        color: get_color_from_hex('#1E3A5F')
                        padding: [0, 0, 0, dp(10)]

                    MDSeparator:

                    # --- Güçlü Yönler Bölümü ---
                    ReportSectionHeader:
                        icon: 'star-circle-outline'
                        text: "Güçlü Yönler"

                    ReportContentLabel:
                        id: strengths_label
                        text: "Rapor verileri bekleniyor..."

                    Widget:
                        size_hint_y: None
                        height: dp(15)

                    # --- Gelişim Alanları Bölümü ---
                    ReportSectionHeader:
                        icon: 'lightbulb-on-outline'
                        text: "Gelişim Alanları"

                    ReportContentLabel:
                        id: development_areas_label
                        text: "Rapor verileri bekleniyor..."

                    Widget:
                        size_hint_y: None
                        height: dp(15)

                    # --- Öneriler Bölümü ---
                    ReportSectionHeader:
                        icon: 'clipboard-check-outline'
                        text: "Ebeveynler ve Eğitmenler İçin Öneriler"

                    ReportContentLabel:
                        id: recommendations_label
                        text: "Rapor verileri bekleniyor..."